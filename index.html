<html>
<head>
	<script src="http://code.jquery.com/jquery-1.10.1.min.js"></script>
	<script src="jquery.cookie.js"></script>
	<link rel="stylesheet" type="text/css" href="button.css">
    <style>
		tr td:first-child {padding-left:0px;}
 		td {padding:10px 0px 10px 10px;}
 		.right { float: right; }
 		.button { border-radius: 15px; }
	</style>
</head>
<body>
<div class="right">
    <a href="https://github.com/semorrison/arxiv-match/">(github)</a> <a href="https://github.com/semorrison/arxiv-match/issues">(issues)</a>
</div>
This webpage will let you decide if candidate matches between the arxiv and mathscinet are correct.
<table width=100%>
	<tr>
		<td width=45%>
			<div id="arxiv-url-line">Loading ... <a id="arxiv-url" href=""></a></div>
			<iframe id="arxiv-iframe" width=100% height=600></iframe>
		</td>
		<td style="text-align: center;">
			<div class="button green" id="same">===&gt; same &lt;===</div>
			<div class="button grey" id="skip">==== skip ====</div>			
			<div class="button red" id="diff">&lt;=== diff ===&gt;</div>
			<hr/>
			<span style="text-align: left;">
			Your name:
			<input id="name"/>
			Comments:
			<textarea id="comments"></textarea>
			</span>
		</td>
		<td width=45%>
			<div id="other-url-line">Loading ... <a id="other-url" href=""></a></div>
			<iframe id="other-iframe" width=100% height=600/></iframe>
		</td>
	</tr>
</table>
<script>
$('#name').val($.cookie("name"));
$('#name').keyup(function() { $.cookie("name", $('#name').val()); });
</script>
<script>
var lastResponse;
function callback(response) {
	lastResponse = response;
	var arxivURL = 'http://arxiv.org/pdf/' + response.arxivid;
	$('#arxiv-url').text(arxivURL);	
	$('#arxiv-url').attr('href', arxivURL);
	$('#arxiv-url-line').show();
	$('#other-url').text(response.bestURL);	
	$('#other-url').attr('href', response.bestURL);
	$('#other-url-line').show();
	$('#arxiv-iframe').attr('src', arxivURL);
	if(response.bestURL.indexOf('oxfordjournals.org') == -1) {
		$("#other-iframe").removeAttr('sandbox');
	} else {
		$("#other-iframe").attr('sandbox', "allow-same-origin allow-scripts allow-forms allow-popups");
	}
	$('#other-iframe').attr('src', response.bestURL);
}
$(document).ready(function() {
	next(true);
});
$('#same').click(function() { next(false, true); });
$('#skip').click(function() { next(true); });
$('#diff').click(function() { next(false, false); });
function next(skip, match) {
	var query = skip ? "" : ("MRNumber=" + lastResponse.MRNumber + "&arxivid=" + lastResponse.arxivid + "&match=" + (match ? "true" : "false") + "&name=" + escape($('#name').val()) + "&comment=" +  escape($('#comments').val()));
	$('#comments').val('');
	$('#arxiv-url-line').hide();
	$('#other-url-line').hide();
	$('#arxiv-iframe').attr('src', '');
	$('#other-iframe').attr('src', '');

	$.getJSON("http://obscure-inlet-8686.herokuapp.com/?callback=?&" + query, callback);	
}
</script>

</body>
</html>
